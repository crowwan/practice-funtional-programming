## 현실에서의 함수형 사고

피자 가게에서 로봇을 이용해 피자를 만든다고 생각해보자. 함수형 프로그래밍을 적용하기 위해서는 우선 피자를 만드는 과정을 액션, 계산 데이터로 나눌 수 있어야 한다.

1. 액션
   액션은 호출 횟수와 시점에 의존한다. 오븐이나 배달차 같은 자원과 요리 재료를 사용하는 것은 액션이다. - 반죽 펴기, 피자 배달, 재료 주문...

2. 계산
   어떤 것을 결정하거나 계획하는 것은 계산이다. 계산은 실행해도 외부에 영향을 주지 않는다. - 조리법에 나온 것을 두 배로 만들기, 쇼핑할 물품 목록 결정하기

3. 데이터
   변경 불가능한 데이터를 가능한 많이 사용해야 한다. 결제, 재고, 피자 조리법과 같은 것들이 데이터다. 데이터는 유연하기 때문에 저장하거나 네트워크로 전송하는 등 다양하게 쓰일 수 있다. - 고객 주문, 영수증, 조리법

## 계층화 설계를 해보자

변경 가능성에 따라 코드를 나눈다. 위쪽으로 갈 술록 자주 변겨오디는 코드가 있고, 아래쪽으로 갈수록 자주 변경되지 않는 코드가 있다.
가장 변하지 않는 것은 프로그래밍 언어 자체다. 그래서 가장 아래쪽은 배열이나 객체와 같은 언어 기능이 놓인다. 그 위는 바뀔 수도 있지만, 자주 바뀌지 않는 피자 조리에 대한 것이 있을 수 있다. 가장 위쪽은 이번 주 메뉴와 같이 자주 바뀌는 사업적인 내용이 있다.

각 계층은 아래의 계층을 기반으로 만들어진다. 그래서 각 계층은 더 안정적인 기반 위에 작성된다. 아래에 있는 코드는 위에 있는 코드보다 의존성이 많아 바꾸기 어렵지만, 자주 바뀌지 않는다.

이처럼 계층형 설계를 만들 수 있고, 일반적으로 비즈니스 규칙, 도메인 규칙, 기술 스택 계층으로 나눌 수 있다. 계층형 설계를 이용한 코드는 테스트, 재사용, 유지보수가 쉽다.

## 타임라인 다이어그램

피자를 만드는 액션들을 시간 순으로 다이어그램을 만들 수 있다. 액션들은 실행 시점에 의존하기 때문에 순서가 중요하다. 분산 시스템을 이용하여 동시에 수행할 수 있는 액션을 나눌 수 있고, 이 역시 타임라인으로 시각화할 수 있다.

하지만, 각각의 타임라인을 맞추지 않으면 분산 시스템은 예측 부락능한 순서로 실행된다. 이때 **커팅**이란 기술을 사용할 수 있다. 타임라인 커팅은 여러 타임라인이 동시에 진행될 때 서로 순서를 맞추는 방법이다.

타임라인 커팅은 고차 동작으로 구현한다. 각 타임라인은 독립적으로 동작하고 작업이 완료되면 다른 타임라인 끝나기를 기다리기 때문에 여러 ㅌ타임라인이 먼저 끝나도 괜찮다.

### 타임라인을 통해 배울 수 있는 것

#### 1. 타임라인 커팅으로 서로 다른 작업들을 쉽게 이해할 수 있다.

타임라인 커팅으로 더 짧아진 타임라인을 실행 순서에 상관없이 이해할 수 있다.

#### 2. 타임라인 다이어그램을 사용하면 시간에 따라 진행하는 작업을 쉽게 이해할 수 있다.

타임라인은 동시에 실행되는 분산 시스템을 시각화하기 좋고, 동작 방법에 대해 확신을 가질 수 있게 한다.

#### 3. 타임라인 다이어그램은 유연하다.

타임라인을 보고 쉽게 코드를 작성할 수 있고, 타임라인 다이어그램으로 동시에 진행되는 작업을 쉽게 모델링할 수 있다.
